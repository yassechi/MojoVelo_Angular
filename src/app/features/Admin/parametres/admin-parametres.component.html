<div class="card">
  <h2 class="mb-4">Paramètres du profil</h2>

  <!-- Navigation par boutons -->
  <div class="flex gap-2 mb-4">
    <p-button
      label="Informations personnelles"
      icon="pi pi-user"
      [outlined]="activeTab !== 'profile'"
      (onClick)="setActiveTab('profile')"
    ></p-button>
    <p-button
      label="Mot de passe"
      icon="pi pi-lock"
      [outlined]="activeTab !== 'password'"
      (onClick)="setActiveTab('password')"
    ></p-button>
    <p-button
      label="Préférences"
      icon="pi pi-cog"
      [outlined]="activeTab !== 'preferences'"
      (onClick)="setActiveTab('preferences')"
    ></p-button>
  </div>

  <!-- Contenu des onglets -->
  <div class="mt-4">
    <!-- Onglet Informations personnelles -->
    <div *ngIf="activeTab === 'profile'">
      <p-card>
        <ng-template pTemplate="header">
          <div class="p-3">
            <h3 class="m-0">Informations personnelles</h3>
          </div>
        </ng-template>

        <form [formGroup]="profileForm" (ngSubmit)="updateProfile()">
          <div class="grid">
            <div class="col-12 md:col-6">
              <div class="field mb-4">
                <label class="block mb-2 font-semibold">Nom d'utilisateur *</label>
                <input pInputText formControlName="userName" class="w-full" />
                <small class="p-error" *ngIf="profileForm.get('userName')?.invalid && profileForm.get('userName')?.touched">
                  Le nom d'utilisateur est obligatoire
                </small>
              </div>
            </div>

            <div class="col-12 md:col-6">
              <div class="field mb-4">
                <label class="block mb-2 font-semibold">Email *</label>
                <input pInputText type="email" formControlName="email" class="w-full" />
                <small class="p-error" *ngIf="profileForm.get('email')?.invalid && profileForm.get('email')?.touched">
                  Email invalide
                </small>
              </div>
            </div>

            <div class="col-12 md:col-6">
              <div class="field mb-4">
                <label class="block mb-2 font-semibold">Prénom *</label>
                <input pInputText formControlName="firstName" class="w-full" />
              </div>
            </div>

            <div class="col-12 md:col-6">
              <div class="field mb-4">
                <label class="block mb-2 font-semibold">Nom *</label>
                <input pInputText formControlName="lastName" class="w-full" />
              </div>
            </div>

            <div class="col-12 md:col-6">
              <div class="field mb-4">
                <label class="block mb-2 font-semibold">Téléphone *</label>
                <input pInputText formControlName="phoneNumber" class="w-full" />
              </div>
            </div>

            <div class="col-12 md:col-6">
              <div class="field mb-4">
                <label class="block mb-2 font-semibold">Taille (cm)</label>
                <input pInputText type="number" formControlName="tailleCm" class="w-full" />
              </div>
            </div>
          </div>

          <div class="flex justify-content-end mt-4">
            <p-button
              label="Enregistrer les modifications"
              icon="pi pi-check"
              type="submit"
              [loading]="loading"
            ></p-button>
          </div>
        </form>
      </p-card>
    </div>

    <!-- Onglet Mot de passe -->
    <div *ngIf="activeTab === 'password'">
      <p-card>
        <ng-template pTemplate="header">
          <div class="p-3">
            <h3 class="m-0">Modifier le mot de passe</h3>
          </div>
        </ng-template>

        <form [formGroup]="passwordForm" (ngSubmit)="changePassword()" autocomplete="off">
          <div class="grid">
            <div class="col-12">
              <div class="field mb-4">
                <label class="block mb-2 font-semibold">Mot de passe actuel *</label>
                <p-password
                  formControlName="currentPassword"
                  [toggleMask]="true"
                  [feedback]="false"
                  styleClass="w-full"
                  inputStyleClass="w-full"
                  autocomplete="new-password"
                ></p-password>
              </div>
            </div>

            <div class="col-12 md:col-6">
              <div class="field mb-4">
                <label class="block mb-2 font-semibold">Nouveau mot de passe *</label>
                <p-password
                  formControlName="newPassword"
                  [toggleMask]="true"
                  [feedback]="true"
                  styleClass="w-full"
                  inputStyleClass="w-full"
                  autocomplete="new-password"
                ></p-password>
              </div>
            </div>

            <div class="col-12 md:col-6">
              <div class="field mb-4">
                <label class="block mb-2 font-semibold">Confirmer le mot de passe *</label>
                <p-password
                  formControlName="confirmPassword"
                  [toggleMask]="true"
                  [feedback]="false"
                  styleClass="w-full"
                  inputStyleClass="w-full"
                  autocomplete="new-password"
                ></p-password>
                <small class="p-error" *ngIf="passwordForm.get('confirmPassword')?.hasError('passwordMismatch') && passwordForm.get('confirmPassword')?.touched">
                  Les mots de passe ne correspondent pas
                </small>
              </div>
            </div>
          </div>

          <div class="flex justify-content-end mt-4">
            <p-button
              label="Modifier le mot de passe"
              icon="pi pi-check"
              type="submit"
              [loading]="loading"
            ></p-button>
          </div>
        </form>
      </p-card>
    </div>

    <!-- Onglet Préférences -->
    <div *ngIf="activeTab === 'preferences'">
      <p-card>
        <ng-template pTemplate="header">
          <div class="p-3">
            <h3 class="m-0">Préférences</h3>
          </div>
        </ng-template>

        <form [formGroup]="preferencesForm" (ngSubmit)="savePreferences()">
          <div class="grid">
            <div class="col-12 md:col-6">
              <div class="field mb-4">
                <label class="block mb-2 font-semibold">Langue</label>
                <p-select
                  formControlName="language"
                  [options]="languageOptions"
                  optionLabel="label"
                  optionValue="value"
                  styleClass="w-full"
                ></p-select>
              </div>
            </div>

            <div class="col-12">
              <h4 class="mb-3">Notifications</h4>
            </div>

            <div class="col-12">
              <div class="flex align-items-center mb-3">
                <p-checkbox
                  formControlName="emailNotifications"
                  [binary]="true"
                  inputId="emailNotif"
                ></p-checkbox>
                <label for="emailNotif" class="ml-2 cursor-pointer">Recevoir des notifications par email</label>
              </div>
            </div>

            <div class="col-12">
              <div class="flex align-items-center mb-3">
                <p-checkbox
                  formControlName="smsNotifications"
                  [binary]="true"
                  inputId="smsNotif"
                ></p-checkbox>
                <label for="smsNotif" class="ml-2 cursor-pointer">Recevoir des notifications par SMS</label>
              </div>
            </div>

            <div class="col-12">
              <div class="flex align-items-center mb-3">
                <p-checkbox
                  formControlName="newsletterSubscription"
                  [binary]="true"
                  inputId="newsletter"
                ></p-checkbox>
                <label for="newsletter" class="ml-2 cursor-pointer">S'abonner à la newsletter</label>
              </div>
            </div>
          </div>

          <div class="flex justify-content-end mt-4">
            <p-button
              label="Enregistrer les préférences"
              icon="pi pi-check"
              type="submit"
            ></p-button>
          </div>
        </form>
      </p-card>
    </div>
  </div>
</div>
