<div class="employe-form-page">
  <p-toast></p-toast>

  <div class="mb-4 flex justify-content-between align-items-center">
    <div>
      <h1 style="font-family: 'Poppins', sans-serif; font-weight: 700; color: #1e3a8a">
        {{ isEdit ? "Modifier l'employé" : "Créer un employé" }}
      </h1>
      <p class="text-600">Gestion d'un employé</p>
    </div>
    <p-button
      label="Retour"
      icon="pi pi-arrow-left"
      class="p-button-text"
      (click)="goBack()"
    ></p-button>
  </div>

  <p-card>
    <form [formGroup]="form">
      <div class="grid">
        <div class="col-12 md:col-6">
          <div class="field mb-4">
            <label class="block mb-2 font-semibold">Nom d'utilisateur *</label>
            <input pInputText formControlName="userName" class="w-full" />
          </div>
        </div>

        <div class="col-12 md:col-6">
          <div class="field mb-4">
            <label class="block mb-2 font-semibold">Email *</label>
            <input pInputText type="email" formControlName="email" class="w-full" />
          </div>
        </div>

        <div class="col-12 md:col-6">
          <div class="field mb-4">
            <label class="block mb-2 font-semibold">Prénom *</label>
            <input pInputText formControlName="firstName" class="w-full" />
          </div>
        </div>

        <div class="col-12 md:col-6">
          <div class="field mb-4">
            <label class="block mb-2 font-semibold">Nom *</label>
            <input pInputText formControlName="lastName" class="w-full" />
          </div>
        </div>

        <div class="col-12 md:col-6">
          <div class="field mb-4">
            <label class="block mb-2 font-semibold">Téléphone *</label>
            <input pInputText formControlName="phoneNumber" class="w-full" />
          </div>
        </div>

        <div class="col-12 md:col-6">
          <div class="field mb-4">
            <label class="block mb-2 font-semibold">
              Mot de passe {{ isEdit ? '(optionnel)' : '*' }}
            </label>
            <p-password
              formControlName="password"
              [toggleMask]="true"
              [feedback]="false"
              class="w-full"
              inputclass="w-full"
            ></p-password>
            @if (form.get('password')?.invalid && form.get('password')?.touched) {
              <small class="text-red-500 block mt-1">
                @if (form.get('password')?.errors?.['required']) {
                  <span>Mot de passe requis</span>
                }
                @if (form.get('password')?.errors?.['minlength']) {
                  <span>Minimum 8 caracteres</span>
                }
              </small>
            }
          </div>
        </div>

        <div class="col-12 md:col-6">
          <div class="field mb-4">
            <label class="block mb-2 font-semibold">
              Confirmer le mot de passe {{ isEdit ? '(optionnel)' : '*' }}
            </label>
            <p-password
              formControlName="confirmPassword"
              [toggleMask]="true"
              [feedback]="false"
              class="w-full"
              inputclass="w-full"
            ></p-password>
            @if (form.get('confirmPassword')?.invalid && form.get('confirmPassword')?.touched) {
              <small class="text-red-500 block mt-1">
                @if (form.get('confirmPassword')?.errors?.['required']) {
                  <span>Confirmation requise</span>
                }
                @if (form.get('confirmPassword')?.errors?.['passwordMismatch']) {
                  <span>Mots de passe differents</span>
                }
              </small>
            }
          </div>
        </div>

        <div class="col-12 md:col-6">
          <div class="field mb-4">
            <label class="block mb-2 font-semibold">Rôle *</label>
            <p-select
              formControlName="role"
              [options]="roleOptions"
              optionLabel="label"
              optionValue="value"
              class="w-full"
            ></p-select>
          </div>
        </div>

        <div class="col-12 md:col-6">
          <div class="field mb-4">
            <label class="block mb-2 font-semibold">Organisation *</label>
            <p-select
              formControlName="organisationId"
              [options]="organisations"
              optionLabel="name"
              optionValue="id"
              class="w-full"
              placeholder="Sélectionner"
            ></p-select>
          </div>
        </div>

        <div class="col-12">
          <div class="field mb-4">
            <p-checkbox
              formControlName="isActif"
              [binary]="true"
              label="Compte actif"
            ></p-checkbox>
          </div>
        </div>
      </div>

      <div class="flex justify-content-end gap-2 mt-4">
        <p-button label="Annuler" (onClick)="goBack()" class="p-button-text"></p-button>
        <p-button
          [label]="isEdit ? 'Sauvegarder' : 'Créer'"
          icon="pi pi-check"
          (onClick)="onSubmit()"
          [loading]="loading"
        ></p-button>
      </div>
    </form>
  </p-card>
</div>


