<div class="detail-section">
  <h3>Discussion</h3>
  <div class="message-card">

    @if (messages.length === 0) {
      <div class="text-600">Aucun message pour cette demande.</div>
    } @else {
      <div class="message-list" #messageList>
        @for (message of messages; track message.id) {
          <div class="message-item" [class.own]="isOwnMessage(message)">
            <div class="message-bubble">
              <div class="message-author">{{ message.roleLabel }}</div>
              <div class="message-content">{{ message.contenu }}</div>
              <div class="message-date">
                {{ (message.dateEnvoi || message.createdDate) | date: 'dd/MM/yyyy HH:mm' }}
              </div>
            </div>
          </div>
        }
      </div>
    }

    <div class="message-input">
      <textarea
        pInputTextarea
        rows="3"
        class="w-full"
        placeholder="Ecrire un message..."
        [(ngModel)]="messageText"
      ></textarea>
      <div class="flex justify-content-end mt-2">
        <p-button
          label="Envoyer"
          icon="pi pi-send"
          (click)="sendMessage()"
          [disabled]="!messageText.trim()"
        ></p-button>
      </div>
    </div>

  </div>
</div>
